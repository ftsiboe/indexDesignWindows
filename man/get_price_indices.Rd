% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_price_indices.R
\name{get_price_indices}
\alias{get_price_indices}
\title{Build a price-received deflator (PPIPR) series relative to \code{current_year}}
\usage{
get_price_indices(current_year = NULL)
}
\arguments{
\item{current_year}{Integer scalar. The base year used for normalization.
The returned \code{PPIPR} equals 1 for this year.}
}
\value{
A \code{data.table} with two columns:
\itemize{
\item \code{commodity_year} - integer year.
\item \code{PPIPR} - numeric deflator equal to the year's price-received index divided by
the \code{current_year} index.
}
}
\description{
Constructs a table used to deflate nominal FCIP monetary amounts to a common
base year. Returns two columns, \code{commodity_year} and \code{PPIPR}, where \code{PPIPR}
equals the year's price-received index divided by the index in \code{current_year}
(so \code{PPIPR(current_year) == 1}).
}
\details{
\strong{Data sources (from \code{rfcipDemand}):}
\itemize{
\item \code{nassSurveyPriceRecivedIndex} (annual; expects \code{commodity_year}, \code{index_for_price_recived}).
\item \code{nassAgPriceMonthlyIndex} (monthly U.S. agricultural price index; expects
\code{year}, \code{comm}, \code{index}).
}

\strong{Synthesizing the current year (if missing in the annual table):}
\itemize{
\item Compute the arithmetic mean of the monthly index where \code{comm == "Agricultural"} for
both \code{current_year} and \code{current_year - 1}.
\item Multiply last year's annual \code{index_for_price_recived} by the ratio
\code{mean_monthly(current_year) / mean_monthly(current_year - 1)} to derive the
current-year annual index.
\item Append this row with \code{data_source = "calculated"}.
}

\strong{Normalization:}
\itemize{
\item Let the denominator be the (mean) \code{index_for_price_recived} among rows with
\code{commodity_year == current_year} (provides stability if duplicates exist).
\item Define \code{PPIPR = index_for_price_recived / denominator}.
}

\strong{Output shape:}
\itemize{
\item Returns only \code{commodity_year} and \code{PPIPR}, sorted ascending by \code{commodity_year}.
\item If the input annual table contains multiple rows per year, duplicates are preserved
in the output (each with its own \code{PPIPR}). Aggregate if you require strictly one
row per year (see Notes).
}
}
\section{Assumptions & Notes}{

\itemize{
\item Assumes both reference datasets from \strong{rfcipDemand} are available with the
specified columns (including the source's spelling \code{index_for_price_recived}).
\item Monthly means are computed with \code{na.rm = TRUE}.
\item If you need one row per year, post-aggregate:
\code{dt[, .(PPIPR = mean(PPIPR, na.rm = TRUE)), by = commodity_year]}.
}
}

